<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Atomic systems · AtomsBase.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://juliamolsim.github.io/AtomsBase.jl/atomicsystems/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AtomsBase.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li class="is-active"><a class="tocitem" href>Atomic systems</a><ul class="internal"><li><a class="tocitem" href="#Struct-of-Arrays-/-FastSystem"><span>Struct of Arrays / FastSystem</span></a></li><li><a class="tocitem" href="#Atoms-and-FlexibleSystem"><span>Atoms and FlexibleSystem</span></a></li></ul></li><li><a class="tocitem" href="../apireference/">API reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Atomic systems</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Atomic systems</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/AtomsBase.jl/blob/master/docs/src/atomicsystems.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="atomic-systems"><a class="docs-heading-anchor" href="#atomic-systems">Atomic systems</a><a id="atomic-systems-1"></a><a class="docs-heading-anchor-permalink" href="#atomic-systems" title="Permalink"></a></h1><p>Since we anticipate atomic systems to be a commonly needed representation, <code>AtomsBase</code> provides two flexible implementations for this setting. One implementation follows the struct-of-arrays approach introducing the <code>AtomView</code> type to conveniently expose atomic data. The more flexible implementation is based on an array-of-structs approach and can be easily customised, e.g. by adding custom properties or by swapping the underlying <code>Atom</code> struct by a custom one. In both cases the respective datastructures can be used either fully or in parts in downstream packages and we hope these to develop into universally useful types within the Julia ecosystem over time.</p><h2 id="Struct-of-Arrays-/-FastSystem"><a class="docs-heading-anchor" href="#Struct-of-Arrays-/-FastSystem">Struct of Arrays / FastSystem</a><a id="Struct-of-Arrays-/-FastSystem-1"></a><a class="docs-heading-anchor-permalink" href="#Struct-of-Arrays-/-FastSystem" title="Permalink"></a></h2><p>The file <a href="https://github.com/JuliaMolSim/AtomsBase.jl/blob/master/src/fast_system.jl">src/fast_system.jl</a> contains an implementation of AtomsBase based on the struct-of-arrays approach. All species data is stored as plain arrays, but for convenience indexing of individual atoms is supported by a light-weight <code>AtomView</code>. See the implementation files as well as the tests for how these can be used.</p><h2 id="Atoms-and-FlexibleSystem"><a class="docs-heading-anchor" href="#Atoms-and-FlexibleSystem">Atoms and FlexibleSystem</a><a id="Atoms-and-FlexibleSystem-1"></a><a class="docs-heading-anchor-permalink" href="#Atoms-and-FlexibleSystem" title="Permalink"></a></h2><p>A flexible implementation of the interface is provided by the <code>FlexibleSystem</code> and the <code>Atom</code> structs for representing atomic systems.</p><p>An <code>Atom</code> object can be constructed just by passing an identifier (e.g. symbol like <code>:C</code>, atomic number like <code>6</code>) and a vector of positions as</p><pre><code class="language-julia hljs">atom = Atoms(:C, [0, 1, 2.]u&quot;bohr&quot;)</code></pre><p>This automatically fills the atom with standard data such as the atomic mass. Such data can be accessed using the <code>AtomsBase</code> interface functions such as <code>atomic_mass(atom)</code>, <code>position(atom)</code>, <code>velocity(atom)</code>, <code>atomic_mass(atom)</code>, etc. See <a href="https://github.com/JuliaMolSim/AtomsBase.jl/blob/master/src/atom.jl">src/atom.jl</a> for details.</p><p>Custom properties can be easily attached to an <code>Atom</code> by supplying arbitrary keyword arguments upon construction. For example to attach a pseudopotential for using the structure with <a href="https://dftk.org">DFTK</a>, construct the atom as</p><pre><code class="language-julia hljs">atom = Atoms(:C, [0, 1, 2.]u&quot;bohr&quot;, pseudopotential=&quot;hgh/lda/c-q4&quot;)</code></pre><p>which will make the pseudopotential identifier available as <code>atom.pseudopotential</code>. Updating an atomic property proceeds similarly. E.g.</p><pre><code class="language-julia hljs">newatom = Atoms(;atom=atom, atomic_mass=13u&quot;u&quot;)</code></pre><p>makes a new carbon atom with all properties identical to <code>atom</code> (including custom ones), but setting the <code>atomic_mass</code> to 13 units.</p><p>Once the atoms are constructed these can be assembled into a system. For example to place a hydrogen molecule into a cubic box of <code>10Å</code> and periodic boundary conditions, use:</p><pre><code class="language-julia hljs">bounding_box = [[10.0, 0.0, 0.0], [0.0, 10.0, 0.0], [0.0, 0.0, 10.0]]u&quot;Å&quot;
boundary_conditions = [Periodic(), Periodic(), Periodic()]
hydrogen = FlexibleSystem([Atom(:H, [0, 0, 1.]u&quot;bohr&quot;),
                           Atom(:H, [0, 0, 3.]u&quot;bohr&quot;)],
                          bounding_box, boundary_conditions)</code></pre><p>An update constructor is supported as well (see <a href="https://github.com/JuliaMolSim/AtomsBase.jl/blob/master/src/flexible_system.jl">src/flexible_system.jl</a>).</p><p>Oftentimes more convenient are the functions <code>atomic_system</code>, <code>isolated_system</code>, <code>periodic_system</code>, which cover some standard atomic system setups:</p><pre><code class="language-julia hljs"># Same hydrogen system with periodic BCs:
bounding_box = [[10.0, 0.0, 0.0], [0.0, 10.0, 0.0], [0.0, 0.0, 10.0]]u&quot;Å&quot;
hydrogen = periodic_system([:H =&gt; [0, 0, 1.]u&quot;bohr&quot;,
                            :H =&gt; [0, 0, 3.]u&quot;bohr&quot;],
                           bounding_box)

# Silicon unit cell using fractional positions
# (Common for solid-state simulations)
bounding_box = 10.26 / 2 * [[0, 0, 1], [1, 0, 1], [1, 1, 0]]u&quot;bohr&quot;
silicon = periodic_system([:Si =&gt;  ones(3)/8,
                           :Si =&gt; -ones(3)/8],
                           bounding_box, fractional=true)

# Isolated H2 molecule in vacuum (Infinite box and zero dirichlet BCs)
# (Standard setup for molecular simulations)
hydrogen = isolated_system([:H =&gt; [0, 0, 1.]u&quot;bohr&quot;,
                            :H =&gt; [0, 0, 3.]u&quot;bohr&quot;])
</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../overview/">« Overview</a><a class="docs-footer-nextpage" href="../apireference/">API reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Monday 25 April 2022 04:34">Monday 25 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
